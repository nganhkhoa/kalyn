(import "Stdlib.kalyn")

(defn showInt (Func Int String)
  (i)
  (if (== i 0)
    "0"
    (let ((showInt*
           (lambda (i str)
             (if (== i 0)
               str
               (showInt*
                 (/ i 10)
                 (Cons
                   (Char (+ 0x30 (% i 10)))
                   str))))))
      (showInt* i ""))))

(defn showIntList (Func (List Int) String)
  (ints)
  (concat
    ["["
     (intercalate ", " (map showInt ints))
     "]"]))

(defn ord (Func Int Int Ordering)
  (x y)
  (if (< x y)
    LT
    (if (> x y)
      GT
      EQ)))

(public def main (IO Empty)
  (let ((m (mapFromList ord [(Pair 5 Empty)
                             (Pair 8 Empty)
                             (Pair 1 Empty)
                             (Pair 3 Empty)
                             (Pair 9 Empty)
                             (Pair 5 Empty)])))
    (print (showIntList (map fst (mapToList m))))))
